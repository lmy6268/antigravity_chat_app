name: CI & AI Review

on:
  push:
    branches: [ "main", "develop" ]
  pull_request:
    branches: [ "main", "develop" ]

jobs:
  lint:
    name: ESLint & Type Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
          
      - name: Install Dependencies
        run: npm ci
        
      - name: Run Lint
        run: npm run lint

  ai-review:
    name: Gemini AI Review
    runs-on: ubuntu-latest
    needs: lint
    if: github.event_name == 'pull_request'
    permissions:
      contents: read
      pull-requests: write
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Run Gemini Code Review
        uses: google-github-actions/run-gemini-cli@v0.1.16
        with:
          gemini_api_key: ${{ secrets.GEMINI_API_KEY }}
          prompt: |
            ì´ Pull Requestë¥¼ ê²€í† í•˜ê³  **í•œêµ­ì–´ë¡œ** í”¼ë“œë°±ì„ ì œê³µí•´ì£¼ì„¸ìš”.
            
            í”„ë¡œì íŠ¸ëŠ” Next.js 16 + React 19 + TypeScript ê¸°ë°˜ì˜ ì¢…ë‹¨ê°„ ì•”í˜¸í™”(E2EE) WebSocket ì±„íŒ… ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤.
            
            ì¤‘ì  ê²€í†  ì‚¬í•­:
            1. ë³´ì•ˆ: ì•”í˜¸í™” í‚¤ê°€ í´ë¼ì´ì–¸íŠ¸ì—ì„œë§Œ ì²˜ë¦¬ë˜ëŠ”ì§€, publicKey ì¸ì¦ì´ ì˜¬ë°”ë¥¸ì§€ í™•ì¸
            2. íƒ€ì… ì•ˆì •ì„±: TypeScript íƒ€ì… ëª…í™•ì„±, any ì‚¬ìš© ìµœì†Œí™”
            3. ì½”ë“œ ìŠ¤íƒ€ì¼: ESLint/Prettier ê·œì¹™ ì¤€ìˆ˜
            4. ì„±ëŠ¥: React Hook ì˜ì¡´ì„± ë°°ì—´, ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ í™•ì¸
            5. ì•„í‚¤í…ì²˜: DAO/Model ê³„ì¸µ ë¶„ë¦¬ ì ì ˆì„±
            
            ë¦¬ë·° í˜•ì‹:
            - ê¸ì •ì  í”¼ë“œë°±ê³¼ ê°œì„  ì œì•ˆ ëª¨ë‘ í¬í•¨
            - ì½”ë“œ ì˜ˆì‹œì— í•œêµ­ì–´ ì£¼ì„ ì¶”ê°€
            - ì¤‘ìš”ë„: ğŸ”´ ì¤‘ìš”, ğŸŸ¡ ê¶Œì¥, ğŸŸ¢ ì œì•ˆ
 
