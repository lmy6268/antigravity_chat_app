# π” WebSocket μ±„ν… μ• ν”λ¦¬μΌ€μ΄μ…

μΆ…λ‹¨κ°„ μ•”νΈν™”(E2EE)λ¥Ό μ§€μ›ν•λ” μ‹¤μ‹κ°„ μ±„ν… μ• ν”λ¦¬μΌ€μ΄μ…μ…λ‹λ‹¤.

## π“ κ°λ° λ©μ 

μ΄ ν”„λ΅μ νΈλ” λ‹¤μμ„ ν•™μµν•κ³  κµ¬ν„ν•κΈ° μ„ν•΄ κ°λ°λμ—μµλ‹λ‹¤:

- **μ‹¤μ‹κ°„ ν†µμ‹ **: Socket.ioλ¥Ό ν™μ©ν• μ–‘λ°©ν–¥ μ›Ήμ†μΌ“ ν†µμ‹ 
- **λ³΄μ•**: Web Crypto APIλ¥Ό μ΄μ©ν• ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ μΆ…λ‹¨κ°„ μ•”νΈν™”
- **ν’€μ¤νƒ κ°λ°**: Next.js κΈ°λ°μ ν†µν•© ν”„λ΅ νΈμ—”λ“/λ°±μ—”λ“ κµ¬μ΅°
- **λ°μ΄ν„°λ² μ΄μ¤ μ—°λ™**: Supabaseλ¥Ό ν™μ©ν• μ‹¤μ‹κ°„ λ°μ΄ν„° κ΄€λ¦¬
- **ν¬λ΅μ¤ ν”λ«νΌ ν…μ¤νΈ**: HTTPS λ΅μ»¬ κ°λ° ν™κ²½ κµ¬μ¶•

## β¨ μ£Όμ” κΈ°λ¥

### 1. μ‚¬μ©μ μΈμ¦
- μ‚¬μ©μ λ“±λ΅ λ° λ΅κ·ΈμΈ
- bcryptλ¥Ό μ‚¬μ©ν• λΉ„λ°€λ²νΈ ν•΄μ‹±
- localStorage κΈ°λ° μ„Έμ… κ΄€λ¦¬

### 2. μ±„ν…λ°© κ΄€λ¦¬
- μ±„ν…λ°© μƒμ„± (λΉ„λ°€λ²νΈ λ³΄νΈ)
- μ±„ν…λ°© λ©λ΅ μ΅°ν
- μ΄λ€ λ§ν¬ λ³µμ‚¬ κΈ°λ¥
- λ°©μ¥ κ¶ν• κ΄€λ¦¬ (λ°© μ‚­μ )

### 3. μ‹¤μ‹κ°„ λ©”μ‹μ§•
- Socket.io κΈ°λ° μ‹¤μ‹κ°„ λ©”μ‹μ§€ μ „μ†΅/μμ‹ 
- λ©”μ‹μ§€ νμ¤ν† λ¦¬ μλ™ λ΅λ“
- μ°Έκ°€μ λ©λ΅ μ‹¤μ‹κ°„ μ—…λ°μ΄νΈ

### 4. μΆ…λ‹¨κ°„ μ•”νΈν™” (E2EE)
- AES-GCM μ•κ³ λ¦¬μ¦μ„ μ‚¬μ©ν• λ©”μ‹μ§€ μ•”νΈν™”
- PBKDF2λ¥Ό ν†µν• λΉ„λ°€λ²νΈ κΈ°λ° ν‚¤ μ λ„
- μ„λ²„λ” μ•”νΈν™”λ λ°μ΄ν„°λ§ μ²λ¦¬ν•μ—¬ λ³΄μ• κ°•ν™”

### 5. λ¨λ°”μΌ μ§€μ›
- HTTPS λ΅μ»¬ κ°λ° μ„λ²„ (mkcert)
- λ°μ‘ν• λ””μμΈ
- κ°™μ€ λ„¤νΈμ›ν¬ λ‚΄ λ¨λ°”μΌ κΈ°κΈ° μ ‘μ† μ§€μ›

## π›  κΈ°μ  μ¤νƒ

### Frontend
- **Next.js 16.0.3** - React κΈ°λ° ν’€μ¤νƒ ν”„λ μ„μ›ν¬
- **React 19.2.0** - UI λΌμ΄λΈλ¬λ¦¬
- **TypeScript** - νƒ€μ… μ•μ •μ„±
- **Socket.io Client 4.8.1** - μ‹¤μ‹κ°„ ν†µμ‹ 
- **Web Crypto API** - λΈλΌμ°μ € λ„¤μ΄ν‹°λΈ μ•”νΈν™”

### Backend
- **Node.js** - λ°νƒ€μ„ ν™κ²½
- **Custom Next.js Server** - μ»¤μ¤ν…€ μ„λ²„ κµ¬ν„
- **Socket.io 4.8.1** - μ›Ήμ†μΌ“ μ„λ²„
- **Supabase** - PostgreSQL κΈ°λ° λ°±μ—”λ“
- **bcryptjs** - λΉ„λ°€λ²νΈ ν•΄μ‹±

### κ°λ° λ„κµ¬
- **dotenv** - ν™κ²½ λ³€μ κ΄€λ¦¬
- **mkcert** - λ΅μ»¬ SSL μΈμ¦μ„ μƒμ„±
- **cross-env** - ν¬λ΅μ¤ ν”λ«νΌ ν™κ²½ λ³€μ μ„¤μ •

## π” λ³΄μ• μ•„ν‚¤ν…μ²

### μ•”νΈν™” νλ¦„

```
1. μ‚¬μ©μκ°€ λ°© λΉ„λ°€λ²νΈ μ…λ ¥
2. PBKDF2λ΅ μ•”νΈν™” ν‚¤ μ λ„ (ν΄λΌμ΄μ–ΈνΈ)
3. λ©”μ‹μ§€λ¥Ό AES-GCMμΌλ΅ μ•”νΈν™” (ν΄λΌμ΄μ–ΈνΈ)
4. μ•”νΈν™”λ λ°μ΄ν„°λ¥Ό μ„λ²„λ΅ μ „μ†΅
5. μ„λ²„λ” μ•”νΈν™”λ μƒνƒλ΅ DB μ €μ¥ λ° λΈλ΅λ“μΊμ¤νΈ
6. μμ‹ μκ°€ κ°™μ€ λΉ„λ°€λ²νΈλ΅ ν‚¤ μ λ„
7. λ©”μ‹μ§€ λ³µνΈν™” (ν΄λΌμ΄μ–ΈνΈ)
```

### λ³΄μ• νΉμ§•
- β… μ„λ²„λ” ν‰λ¬Έ λ©”μ‹μ§€μ— μ ‘κ·Ό λ¶κ°€
- β… λΉ„λ°€λ²νΈλ” PBKDF2λ΅ ν‚¤ μ λ„ (100,000 iterations)
- β… κ° λ©”μ‹μ§€λ§λ‹¤ λλ¤ IV (Initialization Vector) μ‚¬μ©
- β… HTTPS ν•„μ (Web Crypto API μ”κµ¬μ‚¬ν•­)

## π€ μ„¤μΉ λ° μ‹¤ν–‰

### 1. ν™κ²½ μ„¤μ •

```bash
# μ €μ¥μ† ν΄λ΅ 
git clone <repository-url>
cd next-websocket-demo

# μμ΅΄μ„± μ„¤μΉ
npm install

# ν™κ²½ λ³€μ μ„¤μ •
cp .env.example .env.local
# .env.local νμΌμ„ μ—΄μ–΄ Supabase μ •λ³΄ μ…λ ¥
```

### 2. Supabase μ„¤μ •

`SUPABASE_SETUP.md` νμΌμ„ μ°Έκ³ ν•μ—¬ Supabase ν”„λ΅μ νΈλ¥Ό μƒμ„±ν•κ³  μ¤ν‚¤λ§λ¥Ό μ‹¤ν–‰ν•μ„Έμ”.

### 3. SSL μΈμ¦μ„ μƒμ„± (λ¨λ°”μΌ ν…μ¤νΈμ©)

```bash
# mkcert μ„¤μΉ (Mac)
brew install mkcert

# λ΅μ»¬ CA μ„¤μΉ
mkcert -install

# λ§¥λ¶μ IP μ£Όμ† ν™•μΈ
ipconfig getifaddr en0

# μΈμ¦μ„ μƒμ„± (μ: 192.168.0.3)
mkcert localhost 127.0.0.1 192.168.0.3 ::1
```

### 4. κ°λ° μ„λ²„ μ‹¤ν–‰

```bash
npm run dev
```

- **λ§¥λ¶**: `https://localhost:3000` λλ” `http://localhost:3000`
- **λ¨λ°”μΌ**: `https://[λ§¥λ¶IP]:3000` (μ: `https://192.168.0.3:3000`)

### 5. ν”„λ΅λ•μ… λΉλ“

```bash
npm run build
npm start
```

## π“ λ°°μ΄ μ 

### 1. ν™κ²½ λ³€μ κ΄€λ¦¬
- Next.js μ»¤μ¤ν…€ μ„λ²„μ—μ„λ” `dotenv`λ¥Ό λ…μ‹μ μΌλ΅ μ„¤μ •ν•΄μ•Ό ν•¨
- `process.env`λ” μ„λ²„ μΈ΅μ—μ„λ§ μ‚¬μ© κ°€λ¥
- ν΄λΌμ΄μ–ΈνΈμ— λ…Έμ¶ν•  λ³€μλ” `NEXT_PUBLIC_` μ ‘λ‘μ‚¬ ν•„μ”

### 2. Web Crypto API μ μ•½μ‚¬ν•­
- **HTTPS ν•„μ**: localhostκ°€ μ•„λ‹ ν™κ²½μ—μ„λ” HTTPS κ°•μ 
- **λΈλΌμ°μ € μ „μ©**: μ„λ²„ μ‚¬μ΄λ“ λ λ”λ§ μ‹ μ²΄ν¬ ν•„μ”
- **IP μ£Όμ† μ ‘μ†**: `0.0.0.0`μ€ μ•μ „ν• μ»¨ν…μ¤νΈλ΅ μΈμ •λμ§€ μ•μ

### 3. Socket.io λ©”μ‹μ§€ νλ¦„
- `emit()`: μμ‹ μ„ ν¬ν•¨ν• λ¨λ“  ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅
- `broadcast.emit()`: μμ‹ μ„ μ μ™Έν• λ‹¤λ¥Έ ν΄λΌμ΄μ–ΈνΈμ—κ² μ „μ†΅
- λ©”μ‹μ§€ μ¤‘λ³µ λ°©μ§€λ¥Ό μ„ν•΄ μ†΅μ‹ μλ” UIμ— μ§μ ‘ μ¶”κ°€ν•κ³ , μ„λ²„λ” broadcastλ§ μ‚¬μ©

### 4. Next.js Import κ²½λ΅
- `@/*` λ³„μΉ­μ€ `./src/*`λ¥Ό κ°€λ¦¬ν‚΄
- ν”„λ΅μ νΈ λ£¨νΈμ νμΌ(`lib/`)μ€ μƒλ€ κ²½λ΅ μ‚¬μ© ν•„μ”
- API Routeμ—μ„λ” κ²½λ΅ κΈΈμ΄ μ£Όμ (`../../../../../lib/supabase`)

### 5. λ΅μ»¬ λ„¤νΈμ›ν¬ ν…μ¤νΈ
- `mkcert`λ΅ μ‹ λΆ°ν•  μ μλ” λ΅μ»¬ SSL μΈμ¦μ„ μƒμ„± κ°€λ¥
- λ¨λ°”μΌ κΈ°κΈ°μ—μ„ λ΅μ»¬ IPλ΅ μ ‘μ†ν•μ—¬ ν…μ¤νΈ κ°€λ¥
- μ„λ²„λ” `0.0.0.0`μΌλ΅ λ°”μΈλ”©ν•λ, λΈλΌμ°μ €λ” `localhost` μ‚¬μ©

### 6. μ•”νΈν™” ν‚¤ κ΄€λ¦¬
- ν΄λΌμ΄μ–ΈνΈμ—μ„ ν‚¤λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬
- κ°™μ€ λΉ„λ°€λ²νΈ = κ°™μ€ ν‚¤ (PBKDF2μ salt κ³ μ •)
- μ‹¤μ  ν”„λ΅λ•μ…μ—μ„λ” μ‚¬μ©μλ³„ salt κ¶μ¥

## π“ ν”„λ΅μ νΈ κµ¬μ΅°

```
next-websocket-demo/
β”β”€β”€ src/
β”‚   β”β”€β”€ server/
β”‚   β”‚   β””β”€β”€ server.js        # μ»¤μ¤ν…€ Next.js + Socket.io μ„λ²„
β”‚   β”β”€β”€ app/                 # Next.js App Router
β”‚   β”β”€β”€ components/          # React μ»΄ν¬λ„νΈ
β”‚   β”β”€β”€ dao/                 # Data Access Objects (Supabase)
β”‚   β”β”€β”€ hooks/               # μ»¤μ¤ν…€ ν›…
β”‚   β”β”€β”€ i18n/                # λ‹¤κµ­μ–΄ μ§€μ›
β”‚   β”β”€β”€ lib/                 # μ ν‹Έλ¦¬ν‹° λ° μƒμ
β”‚   β”β”€β”€ models/              # λ„λ©”μΈ λ¨λΈ
β”‚   β””β”€β”€ types/               # νƒ€μ… μ •μ
β”β”€β”€ daily/                   # μ‘μ—… μΌμ§€
β”β”€β”€ study/                   # ν•™μµ μλ£
β””β”€β”€ .env.local               # ν™κ²½ λ³€μ (gitignore)
```

## π” ν–¥ν›„ κ°μ„  μ‚¬ν•­

- [ ] νμΌ μ „μ†΅ κΈ°λ¥
- [ ] μ΄λ―Έμ§€/μμƒ κ³µμ 
- [ ] μμ„±/μμƒ ν†µν™” (WebRTC)
- [ ] PWA μ§€μ›
- [ ] λ‹¤κµ­μ–΄ μ§€μ›
- [ ] ν…λ§ μ„¤μ • (λ‹¤ν¬λ¨λ“)
- [ ] λ©”μ‹μ§€ κ²€μƒ‰ κΈ°λ¥
- [ ] μ½μ ν‘μ‹

## π“ λΌμ΄μ„ μ¤

MIT License

## π‘¤ κ°λ°μ

κ°μΈ ν•™μµ ν”„λ΅μ νΈ

---

**μ°Έκ³  λ¬Έμ„:**
- [Socket.io ν•™μµ μλ£](./study/socketio-guide.md)
- [μΆ…λ‹¨κ°„ μ•”νΈν™” μƒμ„Έ μ„¤λ…](./study/e2e-encryption-guide.md)
- [Supabase μ„¤μ • κ°€μ΄λ“](./SUPABASE_SETUP.md)
- [μ‘μ—… μΌμ§€](./daily/)
